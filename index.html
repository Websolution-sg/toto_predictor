<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>TOTO Predictor</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font: 16px/1.5 Arial; padding: 20px; max-width: 600px; margin: auto; }
    select, button, input { font-size: 1em; margin: 0.5em 0; }
    canvas { max-width: 100%; }
  </style>
</head>
<body>
  <h1>Singapore TOTO Predictor</h1>
  <p>By default, the previous lottery result is selected:</p>
  <div>
    <select id="base1"></select>
    <select id="base2"></select>
    <select id="base3"></select>
  </div>

  <p>Select draw range:</p>
  <select id="drawRange">
    <option value="20">Last 20</option>
    <option value="50">Last 50</option>
    <option value="100">Last 100</option>
  </select>

  <label>
    <input type="checkbox" id="includeAdd"/> Include additional number
  </label>

  <button onclick="predict()">Predict</button>

  <h2>Results</h2>
  <div id="results"></div>
  <canvas id="freqChart"></canvas>

<script>
const historical = [
  // Replace with real Singapore TOTO data: 6 winning + 1 additional
  [5,12,23,32,38,45,7],
  [3,11,18,28,34,49,17],
  /* ... */
];

// Populate selects
for(let i=1;i<=49;i++){
  ['base1','base2','base3'].forEach(id => {
    const opt = document.createElement('option');
    opt.value=opt.textContent=i;
    document.getElementById(id).append(opt);
  });
}

// Prediction logic
function predict(){
  const bases = ['base1','base2','base3'].map(id => +document.getElementById(id).value);
  const range = document.getElementById('drawRange').value;
  const includeAdd = document.getElementById('includeAdd').checked;

  const draws = (range === 'all') ? historical : historical.slice(-range);
  const freq = Array(50).fill(0);
  const compat = Array(50).fill(0);

  draws.forEach(draw => {
    const main = draw.slice(0,6);
    const add = draw[6];
    const pool = includeAdd ? main.concat(add) : main;
    pool.forEach(n => freq[n]++);
    bases.forEach(b => {
      if(pool.includes(b)){
        pool.filter(n => n!==b).forEach(n=> compat[n]++);
      }
    });
  });

  const suggestions = freq
    .map((count,n)=>({n,count,compat:compat[n]}))
    .filter(o=>o.n && !bases.includes(o.n))
    .sort((a,b)=> (b.compat + b.count) - (a.compat + a.count))
    .slice(0,6);

  const rs = document.getElementById('results');
  rs.innerHTML = '<h3>Suggested next numbers:</h3>' +
                 suggestions.map(o=>`<p>${o.n} (freq:${o.count}, compat:${o.compat})</p>`).join('');

  // Chart
  const ctx = document.getElementById('freqChart').getContext('2d');
  new Chart(ctx, {
    type:'bar',
    data:{
      labels: suggestions.map(o=>o.n),
      datasets:[{label:'Score',data:suggestions.map(o=>o.count+o.compat)}]
    },
    options:{scales:{y:{beginAtZero:true}}}
  });
}
</script>
</body>
</html>
